<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>多因子回测分析</title>

    <!-- CSS样式 -->
    <link rel="stylesheet" href="css/main.css">

    <!-- 外部依赖库 -->
    <script src="../lib/jquery.min.js"></script>
    <script src="../lib/echarts.min.js"></script>
    <script src="../lib/dexie.min.js"></script>
    <script src="../lib/socket.io.min.js"></script>
</head>

<body>
    <!-- 页面容器 -->
    <div class="app-container">

        <!-- 顶部工具栏 -->
        <header class="toolbar-container">
            <div class="toolbar-left">
                <!-- <h1 class="app-title">
                    <span class="title-icon">📊</span>
                    实时数据可视化系统
                </h1> -->
                <div class="trading-time-indicator">
                    <span id="trading-status" class="status-indicator">●</span>
                    <span id="trading-time-text">检查交易时间中...</span>
                </div>
            </div>

            <div class="toolbar-center">
                <div class="connection-controls">
                    <button id="connect-btn" class="control-btn primary" title="连接/断开WebSocket">
                        <span class="btn-icon">🔗</span>
                        <span class="btn-text">连接服务器</span>
                    </button>

                    <button id="data-flow-btn" class="control-btn secondary" title="暂停/恢复数据流" disabled>
                        <span class="btn-icon">⏸️</span>
                        <span class="btn-text">暂停数据</span>
                    </button>

                    <button id="clear-data-btn" class="control-btn warning" title="清空图表数据">
                        <span class="btn-icon">🗑️</span>
                        <span class="btn-text">清空数据</span>
                    </button>
                </div>
            </div>

            <div class="toolbar-right">
                <div class="status-panel">
                    <div class="status-item">
                    </div>
                    <div class="status-item">
                        <span class="status-label">服务器时间:</span>
                        <span id="server-time" class="status-value">--:--:--</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- 图表展示区域 -->
        <main class="charts-container">

            <!-- PPIE数据组图表 (Grid1) -->
            <section class="chart-section">
                <div id="ppie-chart" class="chart-container"></div>
            </section>

            <!-- VVIE数据组图表 (Grid2) -->
            <section class="chart-section">
                <div id="vvie-chart" class="chart-container"></div>
            </section>

        </main>

        <!-- 底部信息栏 -->
        <footer class="info-bar">
            <div class="info-left">
                <span class="info-text">交易时间: 09:30:00 - 14:57:00</span>
                <span class="info-separator">|</span>
                <span class="info-text">数据频率: 3秒/次</span>
                <span class="info-separator">|</span>
                <span class="info-text">时区: Asia/Shanghai</span>
            </div>

            <div class="info-center">
                <div id="data-stats" class="data-statistics">
                    <span class="stat-item">接收数据: <span id="received-count">0</span> 条</span>
                    <span class="stat-item">缓存数据: <span id="cached-count">0</span> 条</span>
                    <span class="stat-item">连接时长: <span id="connection-duration">00:00:00</span></span>
                </div>
            </div>

            <div class="info-right">
                <span class="status-label">连接状态:</span>
                <span id="connection-status" class="status-value disconnected">未连接</span>
            </div>
        </footer>

    </div>

    <!-- 加载遮罩 -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-content">
            <div class="spinner"></div>
            <p class="loading-text">正在初始化系统...</p>
        </div>
    </div>

    <!-- 错误提示弹窗 -->
    <div id="error-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content error">
            <div class="modal-header">
                <h3>⚠️ 系统错误</h3>
                <button class="modal-close" onclick="closeErrorModal()">&times;</button>
            </div>
            <div class="modal-body">
                <p id="error-message">出现未知错误</p>
            </div>
            <div class="modal-footer">
                <button class="btn secondary" onclick="closeErrorModal()">关闭</button>
                <button class="btn primary" onclick="retryConnection()">重试连接</button>
            </div>
        </div>
    </div>

    <!-- JavaScript模块加载 -->
    <script src="js/database.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/websocket.js"></script>
    <script src="js/toolbar.js"></script>
    <script src="js/main.js"></script>

</body>

</html>